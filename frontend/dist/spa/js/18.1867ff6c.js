(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{d684:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"q-pa-md"},[n("q-table",{attrs:{title:e.$t("group.Group"),data:e.data,columns:e.columns,filter:e.filter,color:"primary","row-key":"name",loading:e.loading},scopedSlots:e._u([{key:"top",fn:function(t){return[n("q-btn",{attrs:{color:"primary",label:e.$t("group.new"),"no-caps":""},on:{click:e.AddNewGroup}}),n("q-space"),n("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:e.$t("Search"),filled:""},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!0),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}),n("q-btn",{staticClass:"q-ml-md",attrs:{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:t.toggleFullscreen}})]}},{key:"header",fn:function(t){return[n("q-tr",{attrs:{props:t}},e._l(t.cols,(function(o){return n("q-th",{key:o.name,attrs:{props:t}},[e._v("\n          "+e._s(o.label)+"\n        ")])})),1)]}},{key:"body-cell-action",fn:function(t){return[n("q-td",{attrs:{props:t}},[n("q-btn",{attrs:{dense:"",round:"",flat:"",color:"grey",icon:"edit"},on:{click:function(n){return e.editRow(t)}}}),n("q-btn",{attrs:{dense:"",round:"",flat:"",color:"grey",icon:"delete"},on:{click:function(n){return e.deleteRow(t)}}})],1)]}},{key:"body-cell-servers",fn:function(t){return[n("q-td",{attrs:{props:t}},e._l(t.row.servers,(function(t,o){return n("a",{key:o},[e._v("\n          "+e._s(t.name)+"\n          "),n("br")])})),0)]}},{key:"loading",fn:function(){return[n("q-inner-loading",{attrs:{showing:"",color:"primary"}})]},proxy:!0}])}),n("q-dialog",{attrs:{"full-width":"","full-height":"",maximized:!0},model:{value:e.creategroupmodal,callback:function(t){e.creategroupmodal=t},expression:"creategroupmodal"}},[n("q-card",[n("q-card-section",{staticClass:"row items-center q-pb-none"},[n("div",{staticClass:"text-h6"},[e._v(e._s(e.modaltitle))]),n("q-space"),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),n("q-card-section",[n("div",[n("div",{staticClass:"q-pa-md"},[n("q-form",{staticClass:"q-gutter-md",on:{submit:e.onSubmit,reset:e.onReset}},[n("q-input",{attrs:{label:e.$t("Group name"),hint:e.$t("Group name"),"lazy-rules":"",rules:[function(t){return t&&t.length>1||e.$t("Please type group name at least 2 characters")}]},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("div",[e._v("\n                "+e._s(e.$t("group.Servers"))+"\n                "),e._l(e.servers,(function(t,o){return n("div",{key:o,staticClass:"row"},[n("div",{staticClass:"col-lg-6"},[n("q-select",{attrs:{"use-input":"","input-debounce":"0",label:e.$t("group.Server"),options:e.servers_list},on:{filter:e.filterFn},scopedSlots:e._u([{key:"no-option",fn:function(){return[n("q-item",[n("q-item-section",{staticClass:"text-grey"},[e._v("\n                            No results\n                          ")])],1)]},proxy:!0}],null,!0),model:{value:t.server,callback:function(n){e.$set(t,"server",n)},expression:"line.server"}})],1),n("div",{staticClass:"col-lg-1"},[n("div",{staticClass:"block float-left"},[n("q-btn",{attrs:{round:"",icon:"delete"},on:{click:function(t){return e.removeServer(o)}}}),o+1===e.servers.length?n("q-btn",{attrs:{round:"",icon:"add"},on:{click:e.addServer}}):e._e()],1)])])}))],2),n("div",[n("q-btn",{attrs:{label:e.$t("Submit"),type:"submit",color:"primary"}}),n("q-btn",{staticClass:"q-ml-sm",attrs:{label:e.$t("Reset"),type:"reset",color:"primary",flat:""}})],1)],1)],1)])])],1)],1)],1)},r=[],a=(n("ac6a"),n("cadf"),n("06db"),n("456d"),n("7f7f"),[]),s=Object(),i={name:"Group",watch:{servers:function(){this.blockRemoval=this.servers.length<=1}},computed:{modaltitle:{get:function(){return this.create?this.create_title:this.update_title},set:function(e){this.modaltitle=e}}},data:function(){return{columns:[{name:"name",align:"center",label:this.$t("group.table.columns.name.label"),field:"name",sortable:!0},{name:"servers",align:"center",label:this.$t("group.table.columns.servers.label"),field:"servers",sortable:!0},{name:"action",align:"center",label:this.$t("action"),field:"",sortable:!0}],data:[],creategroupmodal:!1,servers:[],name:null,servers_list:a,filter:"",loading:!1,create:!0,create_title:this.$t("group.create_group"),update_title:this.$t("group.update_group"),id:null}},methods:{editRow:function(e){this.create=!1,this.onReset(),this.id=e.row.id;var t=this;this.servers=[],this.servers.push({server:null}),e.row.servers.map((function(e){a.map((function(n){n.value===e.id&&t.servers.unshift({server:{label:n.label,value:e.id}})}))})),this.name=e.row.name,this.creategroupmodal=!0},deleteRow:function(e){var t=this;this.$q.dialog({title:this.$t("Confirm"),message:"".concat(this.$t("group.delete_group",{name:e.row.name})," ?"),cancel:!0,persistent:!0,ok:{push:!0,color:"negative"}}).onOk((function(){t.deleteGroup(e.row.id,e.row.name)}))},AddNewGroup:function(){this.create=!0,this.onReset(),this.creategroupmodal=!0},onSubmit:function(){var e=Object();e.name=this.name;var t=[];this.servers.map((function(e){e.server&&t.push(e.server.value)})),e.servers=t,!0===this.create?this.createGroup(e):this.updateGroup(this.id,e)},onReset:function(){this.name=null,this.servers=[],this.servers.push({server:null})},filterFn:function(e,t){var n=this;t((function(){if(""===e)n.servers_list=a;else{var t=e.toLowerCase();n.servers_list=a.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}}))},addServer:function(){var e=this.servers.filter((function(e){return null===e.number}));e.length>=1&&this.servers.length>0||this.servers.push({server:null})},removeServer:function(e){this.blockRemoval||this.servers.splice(e,1)},fetchServerData:function(){var e=this;e.loading=!0,a=[],this.$axios.get("/common/api/serverinfo/").then((function(t){t.data.map((function(e){a.push({label:"".concat(e.name," ").concat(e.hostname," ").concat(e.ip),value:e.id}),s[e.id]={name:e.name,id:e.id}})),e.loading=!1})).catch((function(t){console.log(t),e.loading=!1}))},fetchdata:function(){var e=this;this.$axios.get("/common/api/servergroupwithserverinfo/").then((function(t){e.data=t.data})).catch((function(e){console.log(e)}))},deleteGroup:function(e,t){var n=this,o=this;this.$axios.delete("/common/api/servergroup/".concat(e,"/")).then((function(e){o.$q.notify({type:"positive",textColor:"grey-10",multiLine:!0,message:"".concat(o.$t("group.delete_group_success",{name:t})," !"),timeout:2e3,position:"top"}),n.fetchServerData(),n.fetchdata()})).catch((function(e){console.log(e);var t=[];e.response.data instanceof Object===!0&&Object.keys(e.response.data).map((function(n){"non_field_errors"===n?t.push("".concat(e.response.data[n])):t.push("".concat(n,": ").concat(e.response.data[n]))})),t.map((function(e){o.$q.notify({type:"negative",color:"red-5",textColor:"white",multiLine:!0,message:e,timeout:5e3,position:"top"})}))}))},createGroup:function(e){var t=this,n=this;this.$axios.post("/common/api/servergroup/",e).then((function(o){n.$q.notify({type:"positive",textColor:"grey-10",multiLine:!0,message:"".concat(n.$t("group.create_group_success",{name:e.name})," !"),timeout:2e3,position:"top"}),n.creategroupmodal=!1,t.fetchServerData(),t.fetchdata()})).catch((function(e){var t=[];e.response.data instanceof Object===!0&&Object.keys(e.response.data).map((function(n){"non_field_errors"===n?t.push("".concat(e.response.data[n])):t.push("".concat(n,": ").concat(e.response.data[n]))})),t.map((function(e){n.$q.notify({type:"negative",color:"red-5",textColor:"white",multiLine:!0,message:e,timeout:5e3,position:"top"})}))}))},updateGroup:function(e,t){var n=this;this.$axios.patch("/common/api/servergroup/".concat(e,"/"),t).then((function(e){n.$q.notify({type:"positive",textColor:"grey-10",multiLine:!0,message:"".concat(n.$t("group.update_group_success",{name:t.name})," !"),timeout:2e3,position:"top"}),n.creategroupmodal=!1,n.fetchdata()})).catch((function(e){console.log(e);var t=[];e.response.data instanceof Object===!0&&Object.keys(e.response.data).map((function(n){"non_field_errors"===n?t.push("".concat(e.response.data[n])):t.push("".concat(n,": ").concat(e.response.data[n]))})),t.map((function(e){n.$q.notify({type:"negative",color:"red-5",textColor:"white",multiLine:!0,message:e,timeout:5e3,position:"top"})}))}))}},mounted:function(){this.addServer()},created:function(){this.fetchServerData(),this.fetchdata()}},c=i,l=n("2877"),u=n("eaac"),p=n("9c40"),d=n("2c91"),f=n("27f9"),m=n("0016"),h=n("bd08"),v=n("357e"),g=n("db86"),b=n("74f7"),y=n("24e8"),_=n("f09f"),q=n("a370"),$=n("0378"),w=n("ddd8"),k=n("66e5"),x=n("4074"),C=n("7f67"),S=n("eebe"),Q=n.n(S),G=Object(l["a"])(c,o,r,!1,null,"20f1c1a8",null);t["default"]=G.exports;Q()(G,"components",{QTable:u["a"],QBtn:p["a"],QSpace:d["a"],QInput:f["a"],QIcon:m["a"],QTr:h["a"],QTh:v["a"],QTd:g["a"],QInnerLoading:b["a"],QDialog:y["a"],QCard:_["a"],QCardSection:q["a"],QForm:$["a"],QSelect:w["a"],QItem:k["a"],QItemSection:x["a"]}),Q()(G,"directives",{ClosePopup:C["a"]})}}]);