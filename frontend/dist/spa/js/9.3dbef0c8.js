(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"0619":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md"},[a("q-tabs",{directives:[{name:"show",rawName:"v-show",value:t.otp_switch,expression:"otp_switch"}],attrs:{align:"left","active-color":"primary",stretch:"","no-caps":"",dense:""},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[a("q-tab",{key:"setting",attrs:{name:"setting"},on:{click:function(e){t.selected="setting"}},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[a("div",[t._v("\n        "+t._s(t.$t("Setting"))+"\n      ")])]),a("q-tab",{key:"mfa",attrs:{name:"mfa"},on:{click:function(e){t.selected="mfa"}},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[a("div",[t._v("\n        "+t._s(t.$t("MFA"))+"\n      ")])])],1),a("q-tab-panels",{staticClass:"fit",attrs:{animated:"","keep-alive":""},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[a("q-tab-panel",{key:"setting",attrs:{name:"setting","keep-alive":""}},[a("q-form",{staticClass:"q-gutter-md",on:{submit:t.onSubmit,reset:t.onReset}},[a("div",{staticClass:"q-gutter-sm"},[a("q-toggle",{attrs:{label:t.$t("settings.helper_swith")},model:{value:t.webterminal_detect,callback:function(e){t.webterminal_detect=e},expression:"webterminal_detect"}})],1),a("div",{staticClass:"q-gutter-sm"},[a("q-toggle",{attrs:{label:t.$t("settings.mfa")},model:{value:t.otp_switch,callback:function(e){t.otp_switch=e},expression:"otp_switch"}})],1),a("div",{staticClass:"q-gutter-sm"},[a("q-toggle",{attrs:{label:t.$t("settings.use_timezone")},model:{value:t.use_tz,callback:function(e){t.use_tz=e},expression:"use_tz"}})],1),a("div",{staticClass:"q-gutter-md row"},[a("q-select",{staticStyle:{width:"40%"},attrs:{filled:"","use-input":"","input-debounce":"0",label:t.$t("settings.timezone"),options:t.timezonelist},on:{filter:t.filterFn},scopedSlots:t._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{staticClass:"text-grey"},[t._v("\n                    No results\n                  ")])],1)]},proxy:!0}]),model:{value:t.timezone,callback:function(e){t.timezone=e},expression:"timezone"}})],1),a("div",[a("q-btn",{attrs:{label:t.$t("Submit"),type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:t.$t("Reset"),type:"reset",color:"primary",flat:""}})],1)])],1),a("q-tab-panel",{directives:[{name:"show",rawName:"v-show",value:t.otp_switch,expression:"otp_switch"}],key:"mfa",attrs:{name:"mfa","keep-alive":""}},[a("q-list",{attrs:{separator:""}},[a("q-item",[a("p",[t._v(t._s(t.$t("If you set up 2 - Step Verification, you should install"))+" "),a("a",{staticClass:"qr-modal",staticStyle:{color:"#3DA8F5"},attrs:{href:"javascript:"},on:{click:t.showGa}},[t._v(t._s(t.$t("Google Authenticator")))]),t._v(".")])]),a("q-item",[a("q-item-section",{attrs:{side:""}},[a("q-avatar",{staticStyle:{width:"150px",height:"auto"},attrs:{square:""}},[null!==t.qrcode?a("img",{staticClass:"q-mt-md",staticStyle:{width:"150px"},attrs:{src:t.qrcode,ratio:1}}):t._e(),null===t.qrcode?a("a",{staticStyle:{"font-size":"small"}},[t._v(t._s(t.message))]):t._e()])],1),a("q-item-section",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-y-md column",staticStyle:{"max-width":"400px"}},[a("q-input",{attrs:{outlined:"",label:t.$t("Verify code")},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{color:"primary"},on:{click:t.bindMfa}},[t._v(t._s(t.$t("Bind MFA")))])]},proxy:!0}]),model:{value:t.mfacode,callback:function(e){t.mfacode=e},expression:"mfacode"}}),a("br"),t._v("\n              "+t._s(t.$t("Scan the QR code on the left then you can obtain the verify code."))+"\n            ")],1)])])],1)],1)],1)],1),a("q-dialog",{model:{value:t.showDownloadLink,callback:function(e){t.showDownloadLink=e},expression:"showDownloadLink"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v(t._s(t.$t("Download Google Authenticator")))])]),a("q-card-section",{staticClass:"q-pt-none",staticStyle:{"min-width":"420px"}},[a("div",{staticClass:"qr-image-goog-auth"}),a("p",{staticClass:"qr-tip"},[t._v(t._s(t.$t("Scan QR code to start download")))])]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"OK",color:"primary"}})],1)],1)],1)],1)},i=[],o=(a("ac6a"),a("cadf"),a("06db"),a("456d"),a("48c6")),n=[],c={name:"Setting",data:function(){return{webterminal_detect:!1,otp_switch:!1,timezone:null,use_tz:!1,timezonelist:n,selected:"setting",qrcode:null,message:null,mfacode:null,showDownloadLink:!1}},methods:{onSubmit:function(){this.updateSettings({timezone:this.timezone,webterminal_detect:this.webterminal_detect,otp_switch:this.otp_switch,use_tz:this.use_tz})},bindMfa:function(){var t=this;this.mfacode?this.$axios.post("/common/api/bindmfa/",{verify_code:this.mfacode}).then((function(e){e.data.status?(o["h"](),t.mfasetting=!1,t.$q.notify({type:"negative",color:"red-5",textColor:"white",multiLine:!0,message:t.$t("Bind mfa success, please login the user again!"),timeout:5e3,position:"top"}),t.$router.push({name:"login"})):t.$q.notify({type:"negative",color:"red-5",textColor:"white",multiLine:!0,message:t.$t("Bind mfa failed, please input a validate verify code!"),timeout:5e3,position:"top"})})):this.$q.notify({type:"negative",color:"red-5",textColor:"white",multiLine:!0,message:this.$t("Please input the mfa code!"),timeout:5e3,position:"top"})},onReset:function(){this.webterminal_detect=!1,this.otp_switch=!1,this.timezone=null,this.use_tz=!1},filterFn:function(t,e){var a=this;e((function(){if(console.log(t),""===t)a.timezonelist=n;else{var e=t.toLowerCase();a.timezonelist=n.filter((function(t){return t.toLowerCase().indexOf(e)>-1}))}}))},fetchtimezonelist:function(){var t=this;t.loading=!0,n=[],this.$axios.get("/common/api/timezonelist/").then((function(e){t.timezonelist=e.data,n=e.data,t.loading=!1})).catch((function(e){console.log(e),t.loading=!1}))},fetchdata:function(){var t=this;t.loading=!0,this.$axios.get("/common/api/settingslist/").then((function(e){t.webterminal_detect=e.data.webterminal_detect,t.otp_switch=e.data.otp_switch,t.use_tz=e.data.use_tz,t.timezone=e.data.timezone,t.loading=!1})).catch((function(e){console.log(e),t.loading=!1}))},updateSettings:function(t){var e=this;this.$axios.patch("/common/api/settings/",t).then((function(t){e.$q.notify({type:"positive",textColor:"grey-10",multiLine:!0,message:e.$t("settings.update_settings_success"),timeout:2e3,position:"top"}),e.creategroupmodal=!1,e.fetchdata()})).catch((function(t){console.log(t);var a=[];t.response.data instanceof Object===!0&&Object.keys(t.response.data).map((function(e){"non_field_errors"===e?a.push("".concat(t.response.data[e])):a.push("".concat(e,": ").concat(t.response.data[e]))})),a.map((function(t){e.$q.notify({type:"negative",color:"red-5",textColor:"white",multiLine:!0,message:t,timeout:5e3,position:"top"})}))}))},showGa:function(){this.showDownloadLink=!0}},created:function(){this.fetchtimezonelist(),this.fetchdata();var t=this;this.$axios.post("/common/api/mfaqrcode/").then((function(e){e.data.status?t.qrcode="data:image/svg+xml;base64,".concat(e.data.data):t.message=e.data.message}))}},l=c,r=(a("5e3a"),a("2877")),d=a("429b"),m=a("7460"),u=a("adad"),p=a("823b"),f=a("0378"),h=a("9564"),g=a("ddd8"),v=a("66e5"),b=a("4074"),_=a("9c40"),w=a("1c1c"),q=a("cb32"),y=a("27f9"),x=a("24e8"),k=a("f09f"),$=a("a370"),z=a("4b7e"),C=a("7f67"),S=a("eebe"),Q=a.n(S),L=Object(r["a"])(l,s,i,!1,null,"70146415",null);e["default"]=L.exports;Q()(L,"components",{QTabs:d["a"],QTab:m["a"],QTabPanels:u["a"],QTabPanel:p["a"],QForm:f["a"],QToggle:h["a"],QSelect:g["a"],QItem:v["a"],QItemSection:b["a"],QBtn:_["a"],QList:w["a"],QAvatar:q["a"],QInput:y["a"],QDialog:x["a"],QCard:k["a"],QCardSection:$["a"],QCardActions:z["a"]}),Q()(L,"directives",{ClosePopup:C["a"]})},"5e3a":function(t,e,a){"use strict";var s=a("bbc6"),i=a.n(s);i.a},bbc6:function(t,e,a){}}]);